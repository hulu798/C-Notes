# 数组初始化

首先定义一个数组`int arr[]`是否需要对数组初始化的问题

- 如果数组`[]`填的是变量(包括`const`修饰的常变量)
	则数组声明的时候不需要初始化:即使`int arr[n]={0};`,只需`int n=10;int arr[n];`即可

	还需要注意的是,数组的长度只需第一次运行到数组声明的时候`n`的值有关,即即使后续`n`的值

	可能改变,但是数组长度不变;

	```c
	#include<stdio.h>
	int main()
	{
		int n=10;
	    int arr[n];
	    n=20;
	    printf("%d\n",sizeof(arr)/sizeof(arr[0]));  
	} //打印结果是10,n第一次把值传递给有关数组长度的变量,后续怎么变不影响管理数组长度的变量
	```

**上述数组称为变长数组(VLA，Variable Length Array)其长度可以使用变量来指定，但该变量必须在定义变长数组之前已经被赋值，并且在变长数组的作用域内，其长度不能再改变。**

- `[]`里面填常量或者不填

	1. `[]`里面填常量:这个时候可以初始化也可以不初始化

	2. `[]`里面不填:这个时候必须初始化

		`int arr[]={0};`或者`int arr[]={0,0,0,0,…,0}`(初始化一个元素,其他元素隐式初始化为0,见下面)

		> [!warning]
		>
		> 由上面知道<font color=blue>数组的声明的那一刻数组的长度已经固定</font>(目前不具备改变长度的方法),所以对于上面的1.方法固定了数组长度为1!

## 字符数组初始化:

>在 C 语言里，当使用初始化列表对数组进行初始化，且初始化列表中的元素数量少于数组定义的大小时，数组中剩余<font color=blue>**未被显式赋值的元素会被自动初始化为对应类型的默认值(隐式初始化为'\0')**</font>。对于字符类型（char），默认值是 '\0'（ASCII 码值为 0），也就是字符串结束符

## 二维数组初始化

- 如果数组行数和列数是变量(只能同时是变量),这个时候不允许初始化—只要有一个是变量另一个必须也是变量,不能是空
- 如果行数和列数不是变量
	- 行数和列数都是整数,这个时候可以初始化也可以不初始化
	- 如果行数为空(列数不能为空),这个时候必须初始化

更高维数组类似,最多只能省略第一维的指标

### **二维数组数组越界**

多维数组在内存中开辟的空间是连续的,有可能越界到其他位置元素而非乱码

比如二维数组列越界一个元素访问,访问的是下一行第一个元素

## **const修饰数组**

> [!tip]
>
> 有时需要把数组设置为只读。这样，程序只能从数组中检索值，不能把
>
> 新值写入数组。要创建只读数组，应该用const声明和初始化数组

```c
const int days[12]={31,28,31,30,31,30,31,31,30,31,30,31};
```



## ==指定初始化器（C99）==

C99 增加了一个新特性：指定初始化器（designated initializer）。利用该特性可以初始化指定的数组元素。例如，只初始化数组中的最后一个元素。对于传统的C初始化语法，必须初始化最后一个元素之前的所有元素，才能初始化它：(==多维数组同理可以指定元素位置初始化==)

```c
int arr[6] = {0,0,0,0,0,212}; // 传统的语法
```

而C99规定，可以在初始化列表中使用带方括号的下标指明待初始化的元素：

```c
int arr[6] = {[5] = 212}; // 把arr[5]初始化为212
```

> [!important]
>
> ==对于一般的初始化，在初始化一个元素后，未初始化的元素都会被设置为0==

> [!warning]
>
> 在初始化元素中间穿插指定初始化器:
>
> 第一，如果指定初始化器后面有更多的值，如该例中的初始化列表中的片段：[4] = 31,30,31，那么
>
> 后面这些值将被用于初始化指定元素后面的元素。也就是说，在days[4]被初始化为31后，days[5]和days[6]将分别被初始化为30和31。第二，如果再次初始化指定的元素，那么最后的初始化将会取代之前的初始化
>
```c
#include <stdio.h>
#define MONTHS 12
int main(void)
{
    int days[MONTHS] = { 31, 28, [4] = 31, 30, 31, [1]= 29 };
    int i;
    for (i = 0; i < MONTHS; i++)
    	printf("%2d %d\n", i + 1, days[i]);
    return 0;
}
```

> [!note]
>
> <font color=red>如果未指定元素大小会怎样？</font>
>
> ```c
> int stuff[] = {1, [6] = 23}; //会发生什么？
> int staff[] = {1, [6] = 4, 9, 10}; //会发生什么？
> ```
>
> 编译器会把数组的大小设置为足够装得下初始化的值。所以，stuff数组有7个元素，编号为0～6；而staff数组的元素比stuff数组多两个（即有9个元素）


